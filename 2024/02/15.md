# 取り組んだ課題一覧
- フルスタックエンジニアが教える 即戦力Railsエンジニア養成講座 | Udemy セクション89から128まで
- Ruby on Rails5 速習実践ガイド 23p

# わかったこと
- エラーメッセージを日本語対応させる:gemfileのi18nを導入する
- developmentの部分に、annotateを追記する。　データベースに接続しなくても、ファイルでデータベースの構造を確認できる
- マイグレーションでモデルが生成された時に、自動でアノテーションを追記する。　docker compose exec web bundle exec rails g annotate:install
- foreign_key: trueで外部キー制約 これにより元のテーブルに存在しないidは参照したテーブルのidとして保存できなくなる.データ不整合を防ぐためにつけるもの
- null:falseでnot null制約になる。
- 1対多の関係を表現する場合はmodelのファイルにhas_many: commentsのように記述する
- 1の側に多のモデルを紐づけるには1にアソシエーションを設定し、多の方に1のモデルを紐づけるにはbelongs_toというアソシエーション
- belongs_toのモデルのテーブルには外部キーのカラムを作成
- rails g controller コントローラー名 アクション --skip-template-engine:コントローラファイルの作成とルートの追加が行われる
- アクションは,create,destroyなどを指定できる --skip-template-engineでviewファイルの作成をスキップできる
- resourcesで管理したほうが楽なので、 resources :comments only: %i[create destroy]でコメントコントローラーを指定して、onlyでcreate,destroyアクションのみに制限
- gemのrails-flogはbinding pryで止めた際に、リクエストパラメータを見やすく整形してくれる、DBから発行されるSQLも整形してくれる
- group :development, :test doのところ　'rails-flog', require: 'flog'でflogライブラリを自動で読み込む
- gemの名前と読み込むライブラリ名が異なる場合はrequire使う
- params.require(:comment).permit(:board_id, :name, :comment) ストロングパラメータを利用して、保存すべきパラメータにフィルタリングする
- 上記の場合だと、commentから:board_id, :name, :commentのパラメータを指定することでこの3つのパラメータのみを受け取れる
- sharedディレクトリは共有するviewを置く場所として使用される
- 多対多の関係を表すために中間テーブルを用意する 
- has_many :tags, through: :board_tagsは中間テーブルを経由して多対多の関連付ける
- has_manyの対象は全て複数形で書く
- dependentオプションをhas_many関連付けに追加することで、関連オブジェクトの自動削除を設定できる. destroyメソッドで有効になる.
- destroyオプションを使用すると、関連付けられたオブジェクトのdestroyメソッドが呼び出されます。これにより、関連オブジェクトのバリデーションやコールバックも実行されます。
- :delete_allオプションを使用すると、SQLのDELETEステートメントが直接データベースに発行され、関連オブジェクトが一括で削除されます。この方法は:destroyオプションに比べてパフォーマンスが良いですが、バリデーションやコールバックは実行されない 
- セッションidはユーザ認証だけではなく、買い物かごの保持などにも使える. flashもセッションを使った仕組み
- ログアウト機能は、セッションidを削除すればok
- gemのbcryptはパスワードを暗号化してDBに保存する。 gemfileの中に入っているのでコメントアウトして解除
- テストコードは、プログラムが期待通りに動作するかを自動で検証するためのコードです。例えば、特定の入力に対して期待される出力が得られるかをテストします。
- RSpecは、読みやすいテストコードを書くためのDSL（ドメイン特化言語）を提供します。RailsプロジェクトにRSpecを導入するには、`Gemfile`にRSpecのgemを追加し、`bundle install`コマンドを実行します。
- ユニットテストの重要性: コード変更による影響範囲の確認と機能の正確性保証。
- RSpecのセットアップ: `gem 'rspec-rails'`の追加と設定ファイルの生成。
- テスト用データベースの準備: `rails db:create RAILS_ENV=test`での作成。
- モデルのユニットテスト: バリデーションとメソッドの振る舞いテスト。
- RSpecの実行: `rspec`コマンドでのテスト実行と結果表示。
- describeブロック: テストの対象を定義し、テストケースのグループを作成
- contextブロック: テストを実行する特定の条件や状況を記述します。異なる条件下でのメソッドの振る舞いを区別するために使用
- itブロック: 個々のテストケースを記述し、期待される振る舞いを定義
- expectメソッド: テスト対象のメソッドを実行し、その結果が期待値と一致するかを検証
- 境界値分析とは、テスト対象の入力値や状態が変化する境界に着目し、その前後での挙動を検証するテスト手法
- テスト環境にrails-controller-testing gemを追加する
- レンダリングされるビューや、アクションからビューへ渡される変数をテストする能力が強化される方法
- redirect_to :backはhttpヘッダーの情報を見てリダイレクト先を決定している。テストケースの場合は、リダイレクト先がないので@referer = 'http://localhost'  @request.env['HTTP_REFERER'] = @refererのように指定する。
- パス.rb:行数で指定した行数からテストを実行できる
- 

# 次やること
- Ruby on Rails5 速習実践ガイド 24p

# 感じたこと
- 全体的に内容が難しく、一度で覚えられる知識量が少なくて理解度がまだまだ低いことがわかった
- 特にRSpecのサンプルのテスト内容と結果の出力で違いがわからなかった
- やっとUdemy視聴が終わったので明日から日曜日までに読み切れるように頑張りたい

# 学習時間
- 6.5時間

# 累計学習時間
- 485.5時間
